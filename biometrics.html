<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Serif — Multi-Cadence Integration</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body { 
    width: 100%; height: 100%; 
    background: #0a0e14; 
    font-family: 'SF Mono', 'Fira Code', 'Courier New', monospace;
    color: #8b949e;
    overflow: hidden;
    cursor: none;
  }
  .container {
    width: 100%; height: 100%;
    display: flex; flex-direction: column;
    padding: 14px 28px 10px;
  }
  .header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 8px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(139,148,158,0.10);
    flex-shrink: 0;
  }
  .header .logo {
    font-size: 13px; letter-spacing: 8px; text-transform: uppercase;
    color: rgba(139,148,158,0.30);
  }
  .header .status {
    font-size: 9px; color: rgba(139,148,158,0.18);
    letter-spacing: 3px;
  }
  .rows {
    flex: 1; display: flex; flex-direction: column;
    gap: 0;
    min-height: 0; /* allow flex children to shrink */
  }
  .row {
    flex: 1; display: flex; align-items: stretch;
    position: relative;
    min-height: 0;
  }
  .row + .row {
    border-top: 1px solid rgba(139,148,158,0.06);
  }
  .row-label {
    width: 150px; display: flex; flex-direction: column;
    justify-content: center; padding-right: 16px;
    flex-shrink: 0;
  }
  .row-label .name {
    font-size: 10px; letter-spacing: 3px; text-transform: uppercase;
    margin-bottom: 3px;
  }
  .row-label .value {
    font-size: 26px; font-weight: 300;
    letter-spacing: -0.5px;
    line-height: 1;
  }
  .row-label .unit {
    font-size: 8px; letter-spacing: 1.5px;
    opacity: 0.4; margin-top: 3px;
  }
  .row-label .cadence {
    font-size: 7px; letter-spacing: 1.5px;
    opacity: 0.20; margin-top: 4px;
    text-transform: uppercase;
  }
  .wave-container {
    flex: 1; position: relative; overflow: hidden;
    min-height: 0;
  }
  .wave-container canvas {
    width: 100%; height: 100%;
    display: block;
  }
  .sync-line {
    position: absolute; top: 0; bottom: 0;
    width: 1px;
    background: rgba(88,166,255,0.08);
    z-index: 10;
  }

  .row-ecg .row-label .name, .row-ecg .row-label .value { color: #89CCF0; }
  .row-cgm .row-label .name, .row-cgm .row-label .value { color: #f8c8dc; }
  .row-resp .row-label .name, .row-resp .row-label .value { color: #b8aadd; }

  .footer {
    display: flex; justify-content: space-between;
    padding-top: 8px; margin-top: 6px;
    border-top: 1px solid rgba(139,148,158,0.06);
    font-size: 8px; letter-spacing: 3px;
    color: rgba(139,148,158,0.15);
    text-transform: uppercase;
    flex-shrink: 0;
  }
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="logo">serif</div>
    <div class="status">multi-cadence integration</div>
  </div>
  
  <div class="rows" id="rows"></div>

  <div class="footer">
    <span>3 biometric streams</span>
    <span>3 sampling cadences</span>
    <span>unified temporal alignment</span>
  </div>
</div>

<script>
const SIGNALS = [
  { 
    id: 'ecg', name: 'ECG Lead II', value: '72', unit: 'BPM', cadence: '250 Hz · continuous',
    color: '#89CCF0',
    generate: (x, w) => {
      // PQRST with ~5 beats across the width
      const cycle = w / 5;
      const t = (x % cycle) / cycle;
      if (t < 0.06) return 0;
      if (t < 0.11) return Math.sin((t-0.06)/0.05 * Math.PI) * 0.10;  // P
      if (t < 0.15) return 0;                                           // PR
      if (t < 0.17) return -(t-0.15)/0.02 * 0.12;                     // Q
      if (t < 0.21) return -0.12 + (t-0.17)/0.04 * 1.12;             // R up
      if (t < 0.25) return 1.0 - (t-0.21)/0.04 * 1.20;               // R down → S
      if (t < 0.29) return -0.20 + (t-0.25)/0.04 * 0.20;             // S recovery
      if (t < 0.36) return 0;                                          // ST
      if (t < 0.46) return Math.sin((t-0.36)/0.10 * Math.PI) * 0.15; // T
      return 0;
    }
  },
  {
    id: 'cgm', name: 'CGM Glucose', value: '112', unit: 'mg/dL', cadence: '0.003 Hz · every 5 min',
    color: '#f8c8dc',
    generate: (x, w) => {
      // Slow glucose curve — postprandial rise and fall with gentle drift
      const t = x / w;
      // Two "meal" bumps + baseline drift
      const meal1 = Math.exp(-Math.pow((t - 0.25) * 4.5, 2)) * 0.55;
      const meal2 = Math.exp(-Math.pow((t - 0.70) * 5.0, 2)) * 0.40;
      const drift = Math.sin(t * Math.PI * 1.2) * 0.08;
      const base = -0.15; // offset so range sits in middle
      return base + meal1 + meal2 + drift;
    }
  },
  {
    id: 'resp', name: 'Respiration', value: '16', unit: 'breaths/min', cadence: '0.25 Hz · derived',
    color: '#b8aadd',
    generate: (x, w) => {
      // Smooth sinusoidal breathing ~6 cycles
      return (Math.sin(x / w * Math.PI * 6) * 0.50 
            + Math.sin(x / w * Math.PI * 6.15) * 0.10
            + Math.sin(x / w * Math.PI * 18) * 0.03);
    }
  }
];

// Build rows
const rowsEl = document.getElementById('rows');
SIGNALS.forEach(sig => {
  const row = document.createElement('div');
  row.className = `row row-${sig.id}`;
  row.innerHTML = `
    <div class="row-label">
      <div class="name">${sig.name}</div>
      <div class="value">${sig.value}</div>
      <div class="unit">${sig.unit}</div>
      <div class="cadence">${sig.cadence}</div>
    </div>
    <div class="wave-container">
      <canvas id="canvas-${sig.id}"></canvas>
    </div>
  `;
  rowsEl.appendChild(row);
});

// Sync lines
[0.20, 0.40, 0.60, 0.80].forEach(pos => {
  SIGNALS.forEach(sig => {
    const container = document.querySelector(`.row-${sig.id} .wave-container`);
    const line = document.createElement('div');
    line.className = 'sync-line';
    line.style.left = (pos * 100) + '%';
    container.appendChild(line);
  });
});

// Draw static waveforms — fills available height
function drawAll() {
  SIGNALS.forEach(sig => {
    const canvas = document.getElementById(`canvas-${sig.id}`);
    const rect = canvas.parentElement.getBoundingClientRect();
    const dpr = window.devicePixelRatio || 1;
    canvas.width = rect.width * dpr;
    canvas.height = rect.height * dpr;
    canvas.style.width = rect.width + 'px';
    canvas.style.height = rect.height + 'px';
    
    const ctx = canvas.getContext('2d');
    ctx.scale(dpr, dpr);
    const w = rect.width;
    const h = rect.height;
    const mid = h / 2;
    const amp = h * 0.42;  // use more vertical space
    
    // Subtle grid
    ctx.strokeStyle = 'rgba(139,148,158,0.025)';
    ctx.lineWidth = 0.5;
    for (let gx = 0; gx < w; gx += 60) {
      ctx.beginPath(); ctx.moveTo(gx, 0); ctx.lineTo(gx, h); ctx.stroke();
    }
    for (let gy = 0; gy < h; gy += 40) {
      ctx.beginPath(); ctx.moveTo(0, gy); ctx.lineTo(w, gy); ctx.stroke();
    }
    
    // Main trace
    ctx.beginPath();
    ctx.strokeStyle = sig.color;
    ctx.lineWidth = 2;
    ctx.globalAlpha = 0.9;
    for (let x = 0; x < w; x++) {
      const y = mid - sig.generate(x, w) * amp;
      if (x === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
    }
    ctx.stroke();
    
    // Glow
    ctx.beginPath();
    ctx.strokeStyle = sig.color;
    ctx.lineWidth = 6;
    ctx.globalAlpha = 0.05;
    for (let x = 0; x < w; x++) {
      const y = mid - sig.generate(x, w) * amp;
      if (x === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
    }
    ctx.stroke();
    ctx.globalAlpha = 1;
  });
}

drawAll();
window.addEventListener('resize', drawAll);
document.body.addEventListener('click', () => {
  if (!document.fullscreenElement) document.documentElement.requestFullscreen();
});
</script>
</body>
</html>
